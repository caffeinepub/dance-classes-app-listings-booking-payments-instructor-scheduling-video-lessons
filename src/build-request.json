{
  "kind": "build_request",
  "title": "Dance Classes App: Listings, Booking + Payments, Instructor Scheduling, Video Lessons",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Implement Internet Identity sign-in and a user profile record in the backend, including role-based access control for at least: student, instructor, and admin.",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "All"
        ]
      },
      "acceptanceCriteria": [
        "Users can sign in/out with Internet Identity from the frontend.",
        "Backend persists a user profile keyed by Principal with role information.",
        "Only instructors/admins can access instructor management screens and related backend methods.",
        "There is a defined bootstrap mechanism for the first admin (e.g., first registered user becomes admin) and a way for admins to grant/revoke instructor/admin roles."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Create a dance class catalog feature: persist classes in the backend and provide a frontend to browse, search, and view class details.",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "All"
        ]
      },
      "acceptanceCriteria": [
        "Backend supports CRUD for class definitions (at minimum: title, description, dance style, level, duration, price, cover image URL (optional)).",
        "Frontend includes a catalog page with search and basic filters (e.g., style, level) and a class detail view.",
        "Anonymous users can browse the catalog; booking requires sign-in."
      ]
    },
    {
      "id": "REQ-3",
      "text": "Implement instructor schedule management: instructors/admins can create and manage scheduled class sessions (date/time, capacity, location/online link) associated with a class.",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "All"
        ]
      },
      "acceptanceCriteria": [
        "Backend supports creating/updating/deleting class sessions and listing sessions for a class and/or instructor.",
        "Each session includes capacity and tracks remaining spots based on bookings.",
        "Frontend provides an instructor dashboard to manage classes and sessions.",
        "Students can view upcoming sessions for a class on the class detail page."
      ]
    },
    {
      "id": "REQ-4",
      "text": "Implement class booking flow: students can book a specific scheduled session, with booking records persisted in the backend and visible to students and instructors.",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "All"
        ]
      },
      "acceptanceCriteria": [
        "Backend supports creating a booking for a signed-in user for a specific session, preventing double-booking and preventing bookings when capacity is full.",
        "Bookings have a status lifecycle (at minimum: pending_payment, confirmed, cancelled).",
        "Frontend allows a signed-in student to book a session and view their bookings in a ‘My Bookings’ area.",
        "Instructors can see a roster of bookings for their sessions."
      ]
    },
    {
      "id": "REQ-5",
      "text": "Add payments for class bookings using Stripe Checkout: initiate payment for a pending booking and update booking status upon successful payment confirmation.",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "All"
        ]
      },
      "acceptanceCriteria": [
        "Frontend provides a ‘Pay’ action for pending bookings that starts a Stripe Checkout flow.",
        "Backend never exposes Stripe secret keys to the frontend; Stripe keys are configured via environment/secrets appropriate for the project.",
        "After a successful payment, the booking becomes confirmed and the session capacity updates accordingly.",
        "If payment is not completed, the booking remains pending_payment (or is eventually cancellable by the user)."
      ]
    },
    {
      "id": "REQ-6",
      "text": "Provide an on-demand video lessons library: instructors/admins can create/manage lesson entries and students can browse and play lessons from the app.",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "All"
        ]
      },
      "acceptanceCriteria": [
        "Backend persists lesson metadata (at minimum: title, description, dance style/level tags, video URL, optional thumbnail URL).",
        "Frontend includes a video lessons page with list + filtering/search and a lesson detail page with an embedded player for the lesson video URL.",
        "Instructors/admins have a UI to create/edit/delete lesson entries."
      ]
    },
    {
      "id": "REQ-7",
      "text": "Apply a coherent visual theme across the app (colors, typography, spacing, components) suitable for a dance brand, avoiding blue/purple as primary colors.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "All"
        ]
      },
      "acceptanceCriteria": [
        "All primary pages (catalog, class detail, booking flow, instructor dashboard, video lessons) share a consistent design system (buttons, inputs, cards, headings).",
        "Theme uses a distinct palette that is not primarily blue/purple and remains accessible (adequate contrast)."
      ]
    },
    {
      "id": "REQ-8",
      "text": "Add generated static image assets to the frontend and use them in the UI (served from frontend/public/assets/generated).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "All"
        ]
      },
      "acceptanceCriteria": [
        "Generated images exist in frontend/public/assets/generated with the specified filenames.",
        "Frontend references these images directly as static assets (not fetched from the backend).",
        "At least the app header and landing/catalog area visually incorporate the generated branding assets."
      ]
    }
  ],
  "constraints": [
    "Use English for all user-facing UI text.",
    "Backend must remain a single Motoko actor in backend/main.mo; only add backend/migration.mo if an upgrade-safe state migration is required.",
    "Do not edit files under frontend/src/components/ui or other immutable paths; compose those components instead."
  ],
  "nonGoals": [
    "Native mobile app build (iOS/Android).",
    "Real-time chat or live-streaming video classes.",
    "External database integration (e.g., Postgres/Mongo).",
    "Third-party auth providers other than Internet Identity."
  ],
  "imageRequirements": {
    "required": [
      "Dance studio brand logo mark, clean modern vector-style on transparent background (dance-logo.dim_512x512.png)",
      "Warm energetic hero illustration showing silhouettes of dancers in motion, minimal background, wide banner composition (dance-hero.dim_1600x600.png)"
    ],
    "edits": []
  }
}